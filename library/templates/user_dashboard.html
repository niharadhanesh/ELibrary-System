{% extends 'base_user.html' %}

{% block title %}User Dashboard - E-Library{% endblock %}

{% block content %}
<div class="row g-4">
  <!-- Stats Cards -->
  <div class="col-md-3">
    <div class="card card-custom p-3">
      <h5>Books Borrowed</h5>
      <p class="fs-4 fw-bold text-primary mb-0">12</p>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card card-custom p-3">
      <h5>Wishlist</h5>
      <p class="fs-4 fw-bold text-success mb-0">8</p>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card card-custom p-3">
      <h5>Books Returned</h5>
      <p class="fs-4 fw-bold text-warning mb-0">10</p>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card card-custom p-3">
      <h5>Active Borrowings</h5>
      <p class="fs-4 fw-bold text-danger mb-0">2</p>
    </div>
  </div>
</div>

<!-- Charts -->
<div class="row g-4 mt-2">
  <div class="col-lg-6">
    <div class="card card-custom p-3">
      <h5>Reading Activity</h5>
      <canvas id="readingChart" height="150"></canvas>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card card-custom p-3">
      <h5>Favorite Genres</h5>
      <canvas id="genreChart" height="150"></canvas>
    </div>
  </div>
</div>

<div class="row g-4 mt-2">
  <!-- Borrowing Status -->
  <div class="col-lg-6">
    <div class="card card-custom p-3">
      <h5>Borrowing Overview</h5>
      <div style="max-height: 250px;">
        <canvas id="borrowPieChart" style="width:100%; height:100%;"></canvas>
      </div>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="col-lg-6">
    <div class="card card-custom p-3">
      <h5>Recent Activities</h5>
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>Activity</th>
            <th>Book</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><i class="bi bi-book text-primary me-2"></i> Borrowed</td>
            <td><b>Atomic Habits</b></td>
            <td>Oct 3, 2025</td>
          </tr>
          <tr>
            <td><i class="bi bi-heart text-danger me-2"></i> Added to Wishlist</td>
            <td><b>The Midnight Library</b></td>
            <td>Oct 1, 2025</td>
          </tr>
          <tr>
            <td><i class="bi bi-arrow-return-left text-success me-2"></i> Returned</td>
            <td><b>Onyx Storm</b></td>
            <td>Sep 30, 2025</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Charts Script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Reading Activity (Line Chart)
  new Chart(document.getElementById("readingChart"), {
    type: "line",
    data: {
      labels: ["Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct"],
      datasets: [{
        label: "Books Read",
        data: [2, 3, 4, 5, 7, 8, 10],
        borderColor: "#004080",
        backgroundColor: "rgba(0,64,128,0.1)",
        fill: true,
        tension: 0.3
      }]
    },
    options: { responsive: true, plugins: { legend: { display: false } } }
  });

  // Favorite Genres (Bar Chart)
  new Chart(document.getElementById("genreChart"), {
    type: "bar",
    data: {
      labels: ["Fiction", "Romance", "Sci-Fi", "Mystery", "Non-Fiction"],
      datasets: [{
        label: "Books",
        data: [10, 6, 4, 8, 3],
        backgroundColor: ["#004080", "#00bcd4", "#ff9800", "#8e44ad", "#28a745"]
      }]
    },
    options: { responsive: true }
  });

  // Borrowing Overview (Doughnut)
  new Chart(document.getElementById("borrowPieChart"), {
    type: "doughnut",
    data: {
      labels: ["Returned", "Borrowed", "Overdue"],
      datasets: [{
        data: [10, 2, 1],
        backgroundColor: ["#28a745", "#004080", "#dc3545"]
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { position: 'bottom' } }
    }
  });
</script>
{% endblock %}
