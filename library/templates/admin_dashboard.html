{% extends 'base_admin.html' %}

{% block title %}Admin Dashboard - E-Library{% endblock %}

{% block content %}
<div class="row g-4">
  <!-- Stats Cards -->
  <div class="col-md-3">
    <div class="card card-custom p-3">
      <h5>Total Users</h5>
      <p class="fs-4 fw-bold text-primary mb-0">1,245</p>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card card-custom p-3">
      <h5>Total Books</h5>
      <p class="fs-4 fw-bold text-success mb-0">3,870</p>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card card-custom p-3">
      <h5>Active Borrowings</h5>
      <p class="fs-4 fw-bold text-warning mb-0">245</p>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card card-custom p-3">
      <h5>Monthly Revenue</h5>
      <p class="fs-4 fw-bold text-danger mb-0">$4,560</p>
    </div>
  </div>
</div>

<!-- Charts -->
<div class="row g-4 mt-2">
  <div class="col-lg-6">
    <div class="card card-custom p-3">
      <h5>User Growth</h5>
      <canvas id="userChart" height="150"></canvas>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card card-custom p-3">
      <h5>Books by Category</h5>
      <canvas id="booksChart" height="150"></canvas>
    </div>
  </div>
</div>

<div class="row g-4 mt-2">
  <!-- Borrowings Overview (smaller & responsive) -->
  <div class="col-lg-6">
    <div class="card card-custom p-3">
      <h5>Borrowings Overview</h5>
      <div style="max-height: 250px;">
        <canvas id="borrowChart" style="width:100%; height:100%;"></canvas>
      </div>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="col-lg-6">
    <div class="card card-custom p-3">
      <h5>Recent Activities</h5>
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>User</th>
            <th>Action</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><i class="bi bi-person-circle text-primary me-2"></i> John Doe</td>
            <td>Borrowed <b>Project Hail Mary</b></td>
            <td>Oct 2, 2025</td>
          </tr>
          <tr>
            <td><i class="bi bi-person-circle text-primary me-2"></i> Alice</td>
            <td>Registered as new user</td>
            <td>Oct 1, 2025</td>
          </tr>
          <tr>
            <td><i class="bi bi-person-circle text-primary me-2"></i> Mark</td>
            <td>Returned <b>Onyx Storm</b></td>
            <td>Sep 29, 2025</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Charts Script -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // User Growth Line Chart
  new Chart(document.getElementById("userChart"), {
    type: "line",
    data: {
      labels: ["Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct"],
      datasets: [{
        label: "Users",
        data: [200, 400, 600, 850, 1050, 1200, 1245],
        borderColor: "#004080",
        backgroundColor: "rgba(0,64,128,0.1)",
        fill: true,
        tension: 0.3
      }]
    },
    options: { responsive: true, plugins: { legend: { display: false } } }
  });

  // Books by Category Bar Chart
  new Chart(document.getElementById("booksChart"), {
    type: "bar",
    data: {
      labels: ["Fiction", "Non-Fiction", "Sci-Fi", "Romance", "DIY"],
      datasets: [{
        label: "Books",
        data: [1200, 950, 600, 700, 420],
        backgroundColor: ["#004080","#00bcd4","#ff9800","#8e44ad","#28a745"]
      }]
    },
    options: { responsive: true }
  });

  // Borrowings Pie Chart (smaller & responsive)
  new Chart(document.getElementById("borrowChart"), {
    type: "doughnut",
    data: {
      labels: ["Returned", "Borrowed", "Overdue"],
      datasets: [{
        label: "Borrowings",
        data: [180, 245, 35],
        backgroundColor: ["#28a745", "#004080", "#dc3545"]
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { position: 'bottom' } }
    }
  });
</script>
{% endblock %}
